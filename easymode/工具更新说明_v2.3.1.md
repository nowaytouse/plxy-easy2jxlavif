# Easymode å·¥å…·æ›´æ–°è¯´æ˜ v2.3.1

**æ›´æ–°æ—¥æœŸ**: 2025å¹´10æœˆ24æ—¥  
**æ›´æ–°ç±»å‹**: åŠŸèƒ½å¢å¼º + Bugä¿®å¤

---

## ğŸ†• v2.3.1 æ›´æ–°å†…å®¹

### Universal_converter v2.3.1

#### æ–°å¢åŠŸèƒ½
1. âœ… **Apple Live Photo æ™ºèƒ½è·³è¿‡**
   - è‡ªåŠ¨æ£€æµ‹ HEIC/HEIF + MOV é…å¯¹æ–‡ä»¶
   - è·³è¿‡Live Photoçš„é™æ€éƒ¨åˆ†ï¼Œä¿ç•™é…å¯¹å…³ç³»

2. âœ… **åƒåœ¾ç®±ç›®å½•è‡ªåŠ¨æ’é™¤**
   - æ‰«ææ—¶è‡ªåŠ¨è·³è¿‡ `.trash`ã€`.Trash`ã€`Trash` ç›®å½•
   - é¿å…é‡å¤å¤„ç†å·²åˆ é™¤çš„æ–‡ä»¶
   - æå‡æ‰«ææ•ˆç‡

#### ä¿®æ”¹ä½ç½®
- `scanFiles()` å‡½æ•° - æ·»åŠ ç›®å½•è¿‡æ»¤
- `scanOutputDirectory()` å‡½æ•° - æ·»åŠ ç›®å½•è¿‡æ»¤
- `processFile()` å‡½æ•° - æ·»åŠ Live Photoæ£€æµ‹

---

### Media_tools v2.3.1

#### æ–°å¢åŠŸèƒ½
1. âœ… **æ‰©å±•æ ¼å¼æ”¯æŒ**
   - Photoshop: PSD, PSB
   - RAWæ ¼å¼: CR2, CR3, NEF, ARW, DNG, RAF, ORF, RW2
   - æ”¯æŒæ ¼å¼ä» 18ç§ â†’ 26ç§ (+44%)

2. âœ… **é»˜è®¤åƒåœ¾ç®±ç›®å½•**
   - `-trash` å‚æ•°æ”¹ä¸ºå¯é€‰
   - é»˜è®¤ä½¿ç”¨ `<inputDir>/.trash`
   - ç®€åŒ–å‘½ä»¤è¡Œä½¿ç”¨

#### ä½¿ç”¨å¯¹æ¯”

**ä¹‹å‰ç‰ˆæœ¬ (v2.2.0)**:
```bash
# å¿…é¡»æŒ‡å®štrashç›®å½•
media_tools auto -dir /path/to/files -trash /path/to/trash
media_tools dedup -dir /path/to/files -trash /path/to/trash
```

**æ–°ç‰ˆæœ¬ (v2.3.1)**:
```bash
# trashå‚æ•°å¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨.trash
media_tools auto -dir /path/to/files
media_tools dedup -dir /path/to/files

# è¾“å‡º: ğŸ“‚ ä½¿ç”¨é»˜è®¤åƒåœ¾ç®±: /path/to/files/.trash

# ä»å¯è‡ªå®šä¹‰trashä½ç½®
media_tools auto -dir /path/to/files -trash /custom/trash
```

---

## ğŸ“Š å®Œæ•´åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | v2.2.0 | v2.3.0 | v2.3.1 |
|------|--------|--------|--------|
| **Universal_converter** | | | |
| Live Photoæ£€æµ‹ | âŒ | âœ… | âœ… |
| åƒåœ¾ç®±ç›®å½•æ’é™¤ | âŒ | âŒ | âœ… |
| **Media_tools** | | | |
| æ”¯æŒæ ¼å¼ | 18ç§ | 26ç§ | 26ç§ |
| PSD/RAWæ”¯æŒ | âŒ | âœ… | âœ… |
| é»˜è®¤trash | âŒ | âŒ | âœ… |

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. åƒåœ¾ç®±ç›®å½•æ’é™¤

```go
// scanFiles ä¸­çš„ç›®å½•è¿‡æ»¤
if de.IsDir() {
    dirName := filepath.Base(osPathname)
    if dirName == ".trash" || dirName == ".Trash" || dirName == "Trash" {
        return filepath.SkipDir  // è·³è¿‡è¯¥ç›®å½•åŠå…¶å­ç›®å½•
    }
    return nil
}
```

### 2. é»˜è®¤åƒåœ¾ç®±

```go
// å¦‚æœæœªæŒ‡å®štrashç›®å½•ï¼Œä½¿ç”¨é»˜è®¤çš„.trash
if *trashDir == "" {
    *trashDir = filepath.Join(*inputDir, ".trash")
    logger.Printf("ğŸ“‚ ä½¿ç”¨é»˜è®¤åƒåœ¾ç®±: %s", *trashDir)
}
```

### 3. Live Photoæ£€æµ‹

```go
// æ£€æµ‹æ˜¯å¦ä¸ºApple Live Photo
if utils.IsLivePhoto(filePath) {
    logger.Printf("ğŸï¸  æ£€æµ‹åˆ°Apple Live Photoï¼Œè·³è¿‡è½¬æ¢: %s", fileName)
    stats.addOtherSkipped()
    return ""
}
```

---

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### ç®€åŒ–çš„ä½¿ç”¨æ–¹å¼ï¼ˆæ¨èï¼‰

```bash
# æ­¥éª¤1: åˆå¹¶XMPï¼ˆä¸éœ€è¦æŒ‡å®štrashï¼‰
cd ~/Documents/git/plxy-easy2jxlavif/easymode
./media_tools/bin/media_tools auto -dir /path/to/files

# æ­¥éª¤2: è½¬æ¢ä¸ºJXLï¼ˆè‡ªåŠ¨æ’é™¤.trashï¼‰
./universal_converter/bin/universal_converter \
  -input /path/to/files -type jxl -quality 90

# æ­¥éª¤3: è½¬æ¢è§†é¢‘ä¸ºMOVï¼ˆè‡ªåŠ¨æ’é™¤.trashï¼‰
./universal_converter/bin/universal_converter \
  -input /path/to/files -type mov
```

### è‡ªå®šä¹‰åƒåœ¾ç®±ä½ç½®ï¼ˆå¯é€‰ï¼‰

```bash
# å¦‚æœéœ€è¦è‡ªå®šä¹‰trashä½ç½®
./media_tools/bin/media_tools auto \
  -dir /path/to/files \
  -trash /custom/trash/location
```

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•ç¯å¢ƒ
- ç›®å½•: `~/Documents/git/plxy-easy2jxlavif/å®æˆ˜æ–‡ä»¶å¤¹/tes`
- æ–‡ä»¶æ•°: 319ä¸ªï¼ˆå«159ä¸ªXMPï¼Œ7ä¸ªPSDï¼‰

### æµ‹è¯•ç»“æœ

âœ… **PSD XMPåˆå¹¶**:
- 7ä¸ªPSDæ–‡ä»¶å…¨éƒ¨æˆåŠŸåˆå¹¶XMP
- å…ƒæ•°æ®å®Œæ•´ä¿ç•™ï¼ˆå«Photoshopå†å²ï¼‰
- éªŒè¯: `exiftool *.psd | grep XMP` âœ…

âœ… **é»˜è®¤trashåŠŸèƒ½**:
- å‘½ä»¤: `media_tools auto -dir .`ï¼ˆä¸æŒ‡å®štrashï¼‰
- è¾“å‡º: `ğŸ“‚ ä½¿ç”¨é»˜è®¤åƒåœ¾ç®±: ./.trash` âœ…
- 42ä¸ªé‡å¤æ–‡ä»¶ç§»è‡³ `.trash` âœ…

âœ… **åƒåœ¾ç®±æ’é™¤**:
- æ‰«ææ–‡ä»¶: 118ä¸ªï¼ˆæ’é™¤.trashä¸­çš„42ä¸ªï¼‰ âœ…
- .trashç›®å½•ä¸è¢«é‡å¤å¤„ç† âœ…
- è½¬æ¢æ•ˆç‡æå‡ âœ…

### æ€§èƒ½æŒ‡æ ‡
- XMPåˆå¹¶: 159ä¸ªï¼Œ100%æˆåŠŸ
- å›¾ç‰‡è½¬JXL: 151ä¸ªï¼Œ99.3%æˆåŠŸ
- è§†é¢‘è½¬MOV: 1ä¸ªï¼Œ100%æˆåŠŸ
- ç©ºé—´èŠ‚çœ: 94MB (30%)

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. åƒåœ¾ç®±ä½ç½®

**é»˜è®¤è¡Œä¸º**:
- ä¸æŒ‡å®š `-trash` â†’ ä½¿ç”¨ `<dir>/.trash`
- åƒåœ¾ç®±ä¼šåˆ›å»ºåœ¨è¾“å…¥ç›®å½•å†…

**å»ºè®®**:
- ä¸€èˆ¬æƒ…å†µä½¿ç”¨é»˜è®¤å³å¯
- å¤šç›®å½•å…±äº«åƒåœ¾ç®±æ—¶å¯è‡ªå®šä¹‰

### 2. æ’é™¤ç›®å½•

**è‡ªåŠ¨æ’é™¤çš„ç›®å½•**:
- `.trash` (æ¨è)
- `.Trash` (macOSå›æ”¶ç«™)
- `Trash` (å…¶ä»–ç³»ç»Ÿ)

**ä¸ä¼šè¢«å¤„ç†**:
- è¿™äº›ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶
- åŒ…æ‹¬å­ç›®å½•

### 3. Live Photo

**æ£€æµ‹æ¡ä»¶**:
- æ–‡ä»¶æ‰©å±•å: `.heic` æˆ– `.heif`
- å­˜åœ¨åŒå `.mov` æ–‡ä»¶
- ä¾‹å¦‚: `IMG_0001.heic` + `IMG_0001.mov`

**å¤„ç†ç­–ç•¥**:
- è·³è¿‡HEICè½¬æ¢
- MOVæ–‡ä»¶æ­£å¸¸å¤„ç†
- ä¿ç•™Live Photoé…å¯¹å…³ç³»

---

## ğŸ”„ å‡çº§æ–¹æ³•

### æ–¹æ³•1: ç›´æ¥ä½¿ç”¨ï¼ˆæ¨èï¼‰

æ–°ç‰ˆæœ¬å·²ç¼–è¯‘ï¼Œç›´æ¥ä½¿ç”¨ï¼š
```bash
~/Documents/git/plxy-easy2jxlavif/easymode/media_tools/bin/media_tools
~/Documents/git/plxy-easy2jxlavif/easymode/universal_converter/bin/universal_converter
```

### æ–¹æ³•2: ä»æºç ç¼–è¯‘

```bash
# Media_tools
cd ~/Documents/git/plxy-easy2jxlavif/easymode/media_tools
go build -o bin/media_tools main.go

# Universal_converter
cd ~/Documents/git/plxy-easy2jxlavif/easymode/universal_converter
go build -o bin/universal_converter main.go
```

---

## ğŸ“ ç‰ˆæœ¬å†å²

### v2.3.1 (2025-10-24)
- âœ… Universal_converter: æ·»åŠ åƒåœ¾ç®±ç›®å½•æ’é™¤
- âœ… Media_tools: trashå‚æ•°æ”¹ä¸ºå¯é€‰ï¼Œé»˜è®¤.trash

### v2.3.0 (2025-10-24)
- âœ… Universal_converter: æ·»åŠ Live Photoè·³è¿‡
- âœ… Media_tools: æ”¯æŒPSD/PSBå’Œ8ç§RAWæ ¼å¼

### v2.2.0
- åŸå§‹ç‰ˆæœ¬

---

## ğŸ¯ æ¨èç”¨æ³•

### æ ‡å‡†å·¥ä½œæµï¼ˆæœ€ç®€å•ï¼‰

```bash
cd ~/Documents/git/plxy-easy2jxlavif/easymode

# ä¸€è¡Œå‘½ä»¤å®Œæˆæ‰€æœ‰æ“ä½œ
./media_tools/bin/media_tools auto -dir /path/to/files && \
./universal_converter/bin/universal_converter -input /path/to/files -type jxl -quality 90 && \
./universal_converter/bin/universal_converter -input /path/to/files -type mov

# åƒåœ¾æ–‡ä»¶è‡ªåŠ¨è¿›å…¥ /path/to/files/.trash
# Live Photoè‡ªåŠ¨è·³è¿‡
# PSD/RAWçš„XMPè‡ªåŠ¨åˆå¹¶
```

---

**ç¼–è¯‘æ—¶é—´**: 2025å¹´10æœˆ24æ—¥ 03:37  
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡  
**å‘åå…¼å®¹**: âœ… æ˜¯
